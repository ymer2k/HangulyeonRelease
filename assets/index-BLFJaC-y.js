var t=Object.defineProperty,e=(e,s,i)=>(((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(e,"symbol"!=typeof s?s+"":s,i),i);import{p as s}from"./phaser-C2_wa_Fb.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class i extends s.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/bg.png")}create(){this.scene.start("Preloader")}}const o=new Set("ㅂㅃㅈㅉㄷㄸㄱㄲㅅㅆㅁㄴㅇㄹㅎㅋㅌㅊㅍ"),n=new Set("ㅛㅕㅑㅐㅒㅔㅖㅗㅓㅏㅣㅠㅜㅡ"),r="ㄱㄲㄴㄷㄸㄹㅁㅂㅃㅅㅆㅇㅈㅉㅊㅋㅌㅍㅎ",h="ㄱㄲㄳㄴㄵㄶㄷㄹㄺㄻㄼㄽㄾㄿㅀㅁㅂㅄㅅㅆㅇㅈㅊㅋㅌㅍㅎ",a=class t{constructor(t=null,e=null,s=null,i=null){this.choseong=t,this.jungseong=e,this.jongseong1=s,this.jongseong2=i}addChoseong(t){console.assert(o.has(t)),console.assert(null===this.choseong),this.choseong=t}canCombineJungseong(e){return this.jungseong in t.COMBINE_JUNGSEONG&&e in t.COMBINE_JUNGSEONG[this.jungseong]}addJungseong(e){console.assert(n.has(e)),null===this.jungseong?this.jungseong=e:this.canCombineJungseong(e)?this.jungseong=t.COMBINE_JUNGSEONG[this.jungseong][e]:console.assert(!1)}canCombineJongseong(e){return this.jongseong1 in t.COMBINE_JONGSEONG&&e in t.COMBINE_JONGSEONG[this.jongseong1]}addJongseong(t){console.assert(o.has(t)),null===this.jongseong1?this.jongseong1=t:this.canCombineJongseong(t)?this.jongseong2=t:console.assert(!1)}join(){let t=0;const e=["","ㄱ","ㅅ"],s=["","ㅈ","ㅎ"],i=["","ㄱ","ㅁ","ㅂ","ㅅ","ㅌ","ㅍ","ㅎ"],o=["","ㅅ"],n=["","ㅅ"];if(null===this.choseong&&null!==this.jungseong&&null===this.jongseong1&&null===this.jongseong2)return this.jungseong;if(null!==this.choseong&&null===this.jungseong&&null===this.jongseong1&&null===this.jongseong2)return this.choseong;if(null!==this.choseong&&null!==this.jungseong&&null===this.jongseong1&&null===this.jongseong2)t=44032+588*r.indexOf(this.choseong)+28*(this.jungseong.charCodeAt(0)-12623)+0;else if(null!==this.choseong&&null!==this.jungseong&&null!==this.jongseong1&&null===this.jongseong2){let e=h.indexOf(this.jongseong1)+1;t=44032+588*r.indexOf(this.choseong)+28*(this.jungseong.charCodeAt(0)-12623)+e}else{if(null===this.choseong||null===this.jungseong||null===this.jongseong1||null===this.jongseong2)return"";{let a=h.indexOf(this.jongseong1)+1,l=0;"ㄱ"===this.jongseong1?l=e.indexOf(this.jongseong2):"ㄴ"===this.jongseong1?l=s.indexOf(this.jongseong2):"ㄹ"===this.jongseong1?l=i.indexOf(this.jongseong2):"ㅂ"===this.jongseong1?l=o.indexOf(this.jongseong2):"ㅅ"===this.jongseong1?l=n.indexOf(this.jongseong2):console.assert(!1),t=44032+588*r.indexOf(this.choseong)+28*(this.jungseong.charCodeAt(0)-12623)+a+l}}return String.fromCharCode(t)}};e(a,"COMBINE_JUNGSEONG",{"ㅗ":{"ㅏ":"ㅘ","ㅐ":"ㅙ","ㅣ":"ㅚ"},"ㅜ":{"ㅓ":"ㅝ","ㅔ":"ㅞ","ㅣ":"ㅟ"},"ㅡ":{"ㅣ":"ㅢ"}}),e(a,"COMBINE_JONGSEONG",{"ㄱ":{"ㅅ":"ㄳ"},"ㄴ":{"ㅈ":"ㄵ","ㅎ":"ㄶ"},"ㄹ":{"ㄱ":"ㄺ","ㅁ":"ㄻ","ㅂ":"ㄼ","ㅅ":"ㄽ","ㅌ":"ㄾ","ㅍ":"ㄿ","ㅎ":"ㅀ"},"ㅂ":{"ㅅ":"ㅄ"}});let l=a;var d=Phaser.Renderer.WebGL.Utils,u=Phaser.Renderer.WebGL.Utils;const g=Phaser.GameObjects.GetCalcMatrix,c=Phaser.Renderer.Canvas.SetTransform,p={renderWebGL:function(t,e,s,i){e.dirty&&(e.updateData(),e.dirty=!1),s.addToRenderList(e);var o=t.pipelines.set(e.pipeline),n=g(e,s,i),r=o.calcMatrix.copyFrom(n.calc),h=e._displayOriginX,a=e._displayOriginY,l=s.alpha*e.alpha;t.pipelines.preBatch(e),e.isFilled&&function(t,e,s,i,o,n){for(var r=d.getTintAppendFloatAlpha(s.fillColor,s.fillAlpha*i),h=s.pathData,a=s.pathIndexes,l=0;l<a.length;l+=3){var u=2*a[l],g=2*a[l+1],c=2*a[l+2],p=h[u+0]-o,f=h[u+1]-n,x=h[g+0]-o,y=h[g+1]-n,w=h[c+0]-o,m=h[c+1]-n,O=e.getX(p,f),k=e.getY(p,f),S=e.getX(x,y),T=e.getY(x,y),b=e.getX(w,m),R=e.getY(w,m);t.batchTri(s,O,k,S,T,b,R,0,0,1,1,r,r,r,2)}}(o,r,e,l,h,a),e.isStroked&&function(t,e,s,i,o){var n=t.strokeTint,r=u.getTintAppendFloatAlpha(e.strokeColor,e.strokeAlpha*s);n.TL=r,n.TR=r,n.BL=r,n.BR=r;var h=e.pathData,a=h.length-1,l=e.lineWidth,d=l/2,g=h[0]-i,c=h[1]-o;e.closePath||(a-=2);for(var p=2;p<a;p+=2){var f=h[p]-i,x=h[p+1]-o;t.batchLine(g,c,f,x,d,d,l,p-2,!!e.closePath&&p===a-1),g=f,c=x}}(o,e,l,h,a),t.pipelines.postBatch(e)},renderCanvas:function(t,e,s,i){e.dirty&&(e.updateData(),e.dirty=!1),s.addToRenderList(e);var o=t.currentContext;if(c(t,o,e,s,i)){var n=e._displayOriginX,r=e._displayOriginY,h=e.pathData,a=h.length-1,l=h[0]-n,d=h[1]-r;o.beginPath(),o.moveTo(l,d),e.closePath||(a-=2);for(var u=2;u<a;u+=2){var g=h[u]-n,p=h[u+1]-r;o.lineTo(g,p)}o.closePath(),e.isFilled&&(function(t,e,s,i){var o=e.fillColor,n=e.fillAlpha,r=(16711680&o)>>>16,h=(65280&o)>>>8,a=255&o;t.fillStyle="rgba("+r+","+h+","+a+","+n+")"}(o,e),o.fill()),e.isStroked&&(function(t,e,s,i){var o=e.strokeColor,n=e.strokeAlpha,r=(16711680&o)>>>16,h=(65280&o)>>>8,a=255&o;t.strokeStyle="rgba("+r+","+h+","+a+","+n+")",t.lineWidth=e.lineWidth}(o,e),o.stroke()),o.restore()}}},f=Phaser.GameObjects.Shape;class x extends f{get fillColor(){return this._fillColor}set fillColor(t){this._fillColor=t,this.isFilled=null!=t&&this._fillAlpha>0}get fillAlpha(){return this._fillAlpha}set fillAlpha(t){this._fillAlpha=t,this.isFilled=t>0&&null!=this._fillColor}setFillStyle(t,e){return void 0===e&&(e=1),this.fillColor=t,this.fillAlpha=e,this}get strokeColor(){return this._strokeColor}set strokeColor(t){this._strokeColor=t,this.isStroked=null!=t&&this._strokeAlpha>0&&this._lineWidth>0}get strokeAlpha(){return this._strokeAlpha}set strokeAlpha(t){this._strokeAlpha=t,this.isStroked=t>0&&null!=this._strokeColor&&this._lineWidth>0}get lineWidth(){return this._lineWidth}set lineWidth(t){this._lineWidth=t,this.isStroked=t>0&&null!=this._strokeColor}setStrokeStyle(t,e,s){return void 0===s&&(s=1),this.lineWidth=t,this.strokeColor=e,this.strokeAlpha=s,this}updateData(){return this}get width(){return this.geom.width}set width(t){this.resize(t,this.height)}get height(){return this.geom.height}set height(t){this.resize(this.width,t)}setSize(t,e){var s=this.input;return s&&!s.customHitArea&&(s.hitArea.width=t,s.hitArea.height=e),this}resize(t,e){return this.setSize(t,e),this}}Object.assign(x.prototype,p);const y=Phaser.Utils.Objects.GetValue;let w=class{constructor(t,e,s,i,o){void 0===t&&(t=0),void 0===e&&(e=t),void 0===s&&(s=0),void 0===i&&(i=0),void 0===o&&(o=0),this.cornerRadius={},this._width=0,this._height=0,this.setTo(t,e,s,i,o)}setTo(t,e,s,i,o){return this.setPosition(t,e),this.setRadius(o),this.setSize(s,i),this}setPosition(t,e){return this.x=t,this.y=e,this}setRadius(t){return void 0===t&&(t=0),this.radius=t,this}setSize(t,e){return this.width=t,this.height=e,this}get minWidth(){var t=this.cornerRadius;return Math.max(t.tl.x+t.tr.x,t.bl.x+t.br.x)}get minHeight(){var t=this.cornerRadius;return Math.max(t.tl.y+t.bl.y,t.tr.y+t.br.y)}get width(){return this._width}set width(t){null==t&&(t=0),this._width=Math.max(t,this.minWidth)}get height(){return this._height}set height(t){null==t&&(t=0),this._height=Math.max(t,this.minHeight)}get radius(){var t=this.cornerRadius;return Math.max(t.tl.x,t.tl.y,t.tr.x,t.tr.y,t.bl.x,t.bl.y,t.br.x,t.br.y)}set radius(t){var e,s;"number"==typeof t?(e=t,s=t):(e=y(t,"x",0),s=y(t,"y",0));var i=this.cornerRadius;i.tl=m(y(t,"tl",void 0),e,s),i.tr=m(y(t,"tr",void 0),e,s),i.bl=m(y(t,"bl",void 0),e,s),i.br=m(y(t,"br",void 0),e,s)}get radiusTL(){var t=this.cornerRadius.tl;return Math.max(t.x,t.y)}set radiusTL(t){O(this.cornerRadius.tl,t)}get radiusTR(){var t=this.cornerRadius.tr;return Math.max(t.x,t.y)}set radiusTR(t){O(this.cornerRadius.tr,t)}get radiusBL(){var t=this.cornerRadius.bl;return Math.max(t.x,t.y)}set radiusBL(t){O(this.cornerRadius.bl,t)}get radiusBR(){var t=this.cornerRadius.br;return Math.max(t.x,t.y)}set radiusBR(t){O(this.cornerRadius.br,t)}};var m=function(t,e,s){return void 0===t?t={x:e,y:s}:"number"==typeof t&&(t={x:t,y:t}),k(t),t},O=function(t,e){"number"==typeof e?(t.x=e,t.y=e):(t.x=y(e,"x",0),t.y=y(e,"y",0)),k(t)},k=function(t){t.convex=t.x>=0||t.y>=0,t.x=Math.abs(t.x),t.y=Math.abs(t.y)},S=function(t,e,s){var i=s.length;if(i>=2){var o=s[i-2],n=s[i-1];if(t===o&&e===n)return s}return s.push(t,e),s};const T=Phaser.Math.DegToRad;var b=function(t,e,s,i,o,n,r,h,a){r&&n>o?n-=360:!r&&n<o&&(n+=360);var l=T(n-o)/h;o=T(o);for(var d=0;d<=h;d++){var u=o+l*d,g=t+s*Math.cos(u),c=e+i*Math.sin(u);S(g,c,a)}return a};const R=Phaser.Utils.Objects.IsPlainObject,v=Phaser.Utils.Objects.GetValue,P=Phaser.Geom.Polygon.Earcut;class B extends x{constructor(t,e,s,i,o,n,r,h){var a,l,d,u;if(R(e)){var g=e;e=g.x,s=g.y,i=g.width,o=g.height,n=g.radius,r=g.color,h=g.alpha,a=g.strokeColor,l=g.strokeAlpha,d=g.strokeWidth,u=g.shape}void 0===e&&(e=0),void 0===s&&(s=0),void 0===i&&(i=1),void 0===o&&(o=i),void 0===n&&(n=0),void 0===u&&(u=0);var c=new w;if(super(t,"rexRoundRectangleShape",c),this.setShapeType(u),0===this.shapeType){var p=v(n,"radius",n);c.setTo(0,0,i,o,p)}else p={x:i/2,y:o/2},c.setTo(0,0,i,o,p);var f=v(n,"iteration",void 0);this.setIteration(f),this.setPosition(e,s),this.setFillStyle(r,h),void 0!==a&&void 0===d&&(d=2),this.setStrokeStyle(d,a,l),this.updateDisplayOrigin(),this.dirty=!0}updateData(){var t=this.geom,e=this.pathData;e.length=0;var s,i=t.width,o=t.height,n=t.cornerRadius,r=this.iteration+1;if(s=n.tl,j(s))if(s.convex){var h=s.x,a=s.y;b(h,a,s.x,s.y,180,270,!1,r,e)}else b(h=0,a=0,s.x,s.y,90,0,!0,r,e);else S(0,0,e);return s=n.tr,j(s)?s.convex?(h=i-s.x,a=s.y,b(h,a,s.x,s.y,270,360,!1,r,e)):b(h=i,a=0,s.x,s.y,180,90,!0,r,e):S(i,0,e),s=n.br,j(s)?s.convex?(h=i-s.x,a=o-s.y,b(h,a,s.x,s.y,0,90,!1,r,e)):b(h=i,a=o,s.x,s.y,270,180,!0,r,e):S(i,o,e),s=n.bl,j(s)?s.convex?(h=s.x,a=o-s.y,b(h,a,s.x,s.y,90,180,!1,r,e)):b(h=0,a=o,s.x,s.y,360,270,!0,r,e):S(0,o,e),e.push(e[0],e[1]),this.pathIndexes=P(e),this}setShapeType(t){return"string"==typeof t&&(t=G[t]),this.shapeType=t,this}setSize(t,e){return void 0===e&&(e=t),this.geom.width===t&&this.geom.height===e||(this.geom.setSize(t,e),1===this.shapeType&&this.setRadius({x:t/2,y:e/2}),this.updateDisplayOrigin(),this.dirty=!0,super.setSize(t,e)),this}get radius(){return this.geom.radius}set radius(t){this.geom.setRadius(t),this.updateDisplayOrigin(),this.dirty=!0}get radiusTL(){return this.geom.radiusTL}set radiusTL(t){this.geom.radiusTL=t,this.dirty=!0}get radiusTR(){return this.geom.radiusTR}set radiusTR(t){this.geom.radiusTR=t,this.dirty=!0}get radiusBL(){return this.geom.radiusBL}set radiusBL(t){this.geom.radiusBL=t,this.dirty=!0}get radiusBR(){return this.geom.radiusBR}set radiusBR(t){this.geom.radiusBR=t,this.dirty=!0}setRadius(t){return void 0===t&&(t=0),this.radius=t,this}setRadiusTL(t){return void 0===t&&(t=0),this.radiusTL=t,this}setRadiusTR(t){return void 0===t&&(t=0),this.radiusTR=t,this}setRadiusBL(t){return void 0===t&&(t=0),this.radiusBL=t,this}setRadiusBR(t){return void 0===t&&(t=0),this.radiusBR=t,this}get cornerRadius(){return this.geom.cornerRadius}set cornerRadius(t){this.radius=t}setCornerRadius(t){return this.setRadius(t)}get iteration(){return this._iteration}set iteration(t){void 0!==this._iteration?this._iteration!==t&&(this._iteration=t,this.dirty=!0):this._iteration=t}setIteration(t){return void 0===t&&(t=6),this.iteration=t,this}}var j=function(t){return t.x>0&&t.y>0};const G={rectangle:0,circle:1};class E extends s.Scene{constructor(){super("Game"),this.isMouseDown=!1,this.path=[],this.graphics=null,this.grid=[],this.bonuses=[],this.words=[],this.foundWords=new Set,this.timerText=null,this.resultText=null,this.wordBackgroundInner=null,this.resultPointsText=null,this.totalPointsText=null,this.wordBackgroundOuter=null,this.wordPointsBackgroundEllipse=null,this.wordPointsBackgroundEllipseGraphicObject=null,this.totalPoints=0,this.mostValuableWord=0,this.longestWord=0,this.lengthOfLongestWord=0,this.countdown=120,this.padding=10,this.tones=["A3","B3","C3","D3","E3","F3","G3","A4","B4","C4","D4","E4","F4","G4","A5","B5"],this.currentToneIndex=0,this.fontResolution=2,this.letterPoints={"ㅇ":1,"ㄴ":1,"ㄱ":1,"ㄹ":1,"ㅅ":2,"ㅈ":2,"ㅎ":3,"ㄷ":3,"ㅂ":3,"ㅁ":3,"ㅊ":5,"ㅋ":8,"ㅍ":8,"ㄶ":8,"ㅄ":8,"ㅌ":10,"ㄺ":10,"ㄻ":10,"ㅒ":10,"ㅀ":10,"ㄵ":10,"ㄼ":10,"ㅏ":1,"ㅣ":1,"ㅡ":1,"ㅓ":2,"ㅗ":2,"ㅜ":3,"ㅕ":4,"ㅐ":4,"ㅔ":4,"ㅛ":8,"ㅑ":8,"ㅠ":8,"ㅖ":8}}preload(){this.cache.json.remove("gridData");const t=`grid_${Math.floor(50*Math.random())+1}.json`;this.load.json("gridData","assets/grids/"+t),this.countdown=120,this.foundWords=new Set,this.totalPoints=0,this.longestWord=0,this.lengthOfLongestWord=0}create(){this.cameras.main.setBackgroundColor(68719476735),this.cameras.main.setZoom(4.2);const t=this.cache.json.get("gridData");this.grid=t.grid,this.bonuses=t.bonuses,this.words=t.words;const e=50,s=this.sys.game.config.width/2-115,i=this.sys.game.config.height/2-120,r=[];let a=new B(this,{x:s-20,y:i-160,width:270,height:410,radius:6,strokeColor:0,strokeWidth:2,color:void 0,alpha:0}).setOrigin(0,0);this.add.existing(a),this.wordBackgroundOuter=new B(this,{x:this.sys.game.config.width/2-115,y:i-45-35,width:230,height:70,radius:2,strokeColor:0,strokeWidth:2,color:void 0,alpha:0}).setOrigin(0,0),this.add.existing(this.wordBackgroundOuter);let d=new B(this,{x:this.wordBackgroundOuter.x+this.wordBackgroundOuter.width-65,y:this.wordBackgroundOuter.y-e-10,width:65,height:e,radius:2,strokeColor:0,strokeWidth:2,color:void 0,alpha:0}).setOrigin(0,0);this.add.existing(d),this.totalPointsText=this.add.text(d.x+d.width-5,d.y+d.height/2,this.totalPoints.toString().padStart(4," "),{fontSize:"24px",fontFamily:"Arial",color:"#000",align:"right"}).setOrigin(1,.5).setResolution(this.fontResolution);let u=new B(this,{x:this.wordBackgroundOuter.x,y:this.wordBackgroundOuter.y-e-10,width:65,height:e,radius:2,strokeColor:0,strokeWidth:2,color:void 0,alpha:0}).setOrigin(0,0);this.add.existing(u),this.timerText=this.add.text(u.x+u.width/2,u.y+u.height/2,this.formatTime(this.countdown),{fontSize:"24px",fontFamily:"Arial",color:"#000"}).setOrigin(.5,.5).setResolution(this.fontResolution),this.wordBackgroundInner=new B(this,{x:this.wordBackgroundOuter.x+this.wordBackgroundOuter.width/2,y:this.wordBackgroundOuter.y+10,width:10,height:e,radius:2,strokeColor:0,strokeWidth:2,strokeAlpha:0,color:void 0,alpha:0}).setOrigin(.5,0),this.add.existing(this.wordBackgroundInner),this.wordPointsBackgroundEllipse=new Phaser.Geom.Ellipse(this.wordBackgroundInner.x+this.wordBackgroundInner.width/2,this.wordBackgroundInner.y+5,25,25,16777215),this.wordPointsBackgroundEllipseGraphicObject=this.add.graphics();for(let o=0;o<4;o++)for(let t=0;t<4;t++){let n=s+60*t,h=i+60*o,a=this.grid[o][t],l=this.letterPoints[a]||0,d=this.bonuses[o][t],u=this.add.rectangle(n+5,h+5,40,40,16711680).setOrigin(0,0);u.setAlpha(0);let g=new B(this,{x:n+25,y:h+25,width:50,height:e,radius:6,strokeColor:0,strokeWidth:2,color:void 0,alpha:0}).setOrigin(.5,.5);this.add.existing(g),this.add.text(n+25,h+25,a,{fontSize:"32px",color:"#000000"}).setOrigin(.5,.5).setResolution(this.fontResolution),this.add.text(n+50-2.5,h+2.5,l,{fontSize:"12px",color:"#000000"}).setOrigin(1,0).setResolution(this.fontResolution);let c="";if(d){let t=new Phaser.Geom.Ellipse(n+5,h+5,25,25),e=this.add.graphics();switch(d){case 1:e.fillStyle(9286651,1),c="ㄱx2";break;case 2:e.fillStyle(9286651,1),c="ㄱx3";break;case 3:e.fillStyle(15697028,1),c="가x2";break;case 4:e.fillStyle(15697028,1),c="가x3"}e.fillEllipseShape(t),e.lineStyle(2,0,1),e.strokeEllipseShape(t,256),this.add.text(t.x,t.y,c,{fontSize:"10px",color:"#000000"}).setOrigin(.5,.5).setResolution(this.fontResolution)}r.push({rect:u,roundRect:g,letter:a,points:l,bonus:d,index:4*o+t,gridX:t,gridY:o})}this.graphics=this.add.graphics({lineStyle:{width:5,color:255}}),this.input.on("pointerdown",(t=>{this.isMouseDown=!0,this.path=[],this.graphics.clear(),this.checkPointerOverRect(t,r)})),this.input.on("pointermove",(t=>{this.isMouseDown&&this.checkPointerOverRect(t,r)})),this.input.on("pointerup",(()=>{if(this.isMouseDown=!1,this.path.length>1){const t=this.path.map((t=>t.letter)).join("");let e=this.path.reduce(((t,e)=>t+(this.letterPoints[e.letter]||0)),0);const s=(t=>{let e="START",s=new l,i="";for(const r of t)if(o.has(r)||n.has(r)||(i+=s.join(),s=new l,i+=r,e="START"),"START"===e)o.has(r)?(s.addChoseong(r),e="CHOSEONG"):n.has(r)&&(s.addJungseong(r),e="JUNGSEONG1");else if("CHOSEONG"===e)o.has(r)?(i+=s.join(),s=new l(r),e="CHOSEONG"):n.has(r)&&(s.addJungseong(r),e="JUNGSEONG1");else if("JUNGSEONG1"===e)o.has(r)?null!==s.choseong&&h.includes(r)?(s.addJongseong(r),e="JONGSEONG1"):(i+=s.join(),s=new l(r),e="CHOSEONG"):n.has(r)&&(s.canCombineJungseong(r)?(s.addJungseong(r),e="JUNGSEONG2"):(i+=s.join(),s=new l(null,r),e="JUNGSEONG1"));else if("JUNGSEONG2"===e)o.has(r)?null!==s.choseong&&h.includes(r)?(s.addJongseong(r),e="JONGSEONG1"):(i+=s.join(),s=new l(r),e="CHOSEONG"):n.has(r)&&(i+=s.join(),s=new l(null,r),e="JUNGSEONG1");else if("JONGSEONG1"===e){if(o.has(r))s.canCombineJongseong(r)?(s.addJongseong(r),e="JONGSEONG2"):(i+=s.join(),s=new l(r),e="CHOSEONG");else if(n.has(r)){let t=s.jongseong1;s.jongseong1=null,i+=s.join(),s=new l(t,r),e="JUNGSEONG1"}}else if("JONGSEONG2"===e){if(o.has(r))i+=s.join(),s=new l(r),e="CHOSEONG";else if(n.has(r)){let t=s.jongseong2;s.jongseong2=null,i+=s.join(),s=new l(t,r),e="JUNGSEONG1"}}else console.assert(!1);return i+=s.join(),i})(t);console.log(s);let i=1;this.path.forEach((t=>{switch(t.bonus){case 1:e+=this.letterPoints[t.letter]||0;break;case 2:e+=2*(this.letterPoints[t.letter]||0);break;case 3:i*=2;break;case 4:i*=3}})),e*=i,this.words.includes(s)&&!this.foundWords.has(s)?(this.foundWords.add(s),this.totalPoints+=e,this.updateResultTextAndWordPoints(s,e),this.updateTotalPointsText(),console.log(`Match found: ${s}`),t.length>this.lengthOfLongestWord&&(this.longestWord=s,this.lengthOfLongestWord=t.length),e>this.mostValuableWord&&(this.mostValuableWord=e)):(e=0,this.updateResultTextAndWordPoints(s,e),console.log(`No match found for: ${s}`),this.foundWords.has(s)?this.sound.playAudioSprite("effects","RepeatedWord"):this.sound.playAudioSprite("effects","NoWord"))}this.resetRectangles(r),this.resetGridRoundRectangle(r),this.path=[],this.graphics.clear()})),this.resultText=this.add.text(this.wordBackgroundOuter.x+this.wordBackgroundOuter.width/2,this.wordBackgroundOuter.y+15,"",{fontSize:"32px",color:"#000000",padding:{top:10,bottom:10}}).setOrigin(.5,0),this.resultPointsText=this.add.text(this.sys.game.config.width/2+80,this.wordPointsBackgroundEllipse.y,"",{fontSize:"12px",color:"#000000"}).setOrigin(.5,.5),this.time.addEvent({delay:1e3,callback:this.updateTimer,callbackScope:this,loop:!0}),this.hiddenAt=null,document.addEventListener("visibilitychange",(()=>{if(document.hidden)this.hiddenAt=Date.now();else if(this.hiddenAt){const t=(Date.now()-this.hiddenAt)/1e3;this.countdown=Math.max(0,this.countdown-Math.floor(t)),this.hiddenAt=null}}))}checkPointerOverRect(t,e){const s=t.worldX,i=t.worldY;e.forEach((t=>{if(Phaser.Geom.Rectangle.Contains(t.rect.getBounds(),s,i)){const e=this.path[this.path.length-1];if(!e||e.index!==t.index)if(this.path.some((e=>e.index===t.index))){const e=this.path.findIndex((e=>e.index===t.index));this.path.slice(e+1).forEach((e=>{e.roundRect.setFillStyle(255,0),this.shrinkCell(t.roundRect),this.currentToneIndex=this.currentToneIndex-1,console.log(this.currentToneIndex)})),this.path=this.path.slice(0,e+1),this.drawLines()}else e&&!this.areNeighbors(e,t)||(this.path.push(t),t.roundRect.setFillStyle(12776801,1),this.growCell(t.roundRect),this.sound.playAudioSprite("tones",this.tones[this.currentToneIndex]),this.currentToneIndex=(this.currentToneIndex+1)%(this.tones.length+1),console.log(this.currentToneIndex),this.drawLines())}}))}areNeighbors(t,e){const s=Math.abs(t.gridX-e.gridX),i=Math.abs(t.gridY-e.gridY);return s<=1&&i<=1&&!(0===s&&0===i)}resetRectangles(t){t.forEach((t=>{t.rect.setFillStyle(16711680)}))}resetGridRoundRectangle(t){t.forEach((t=>{t.roundRect.setFillStyle(16711680,0),this.shrinkCell(t.roundRect),this.currentToneIndex=0}))}drawLines(){this.graphics.clear(),this.graphics.lineStyle(5,12776801);for(let t=0;t<this.path.length-1;t++){const e=this.path[t].rect.getBounds(),s=this.path[t+1].rect.getBounds(),i=this.getEdgePoint(e,s),o=this.getEdgePoint(s,e);this.graphics.moveTo(i.x,i.y),this.graphics.lineTo(o.x,o.y)}this.graphics.strokePath()}getEdgePoint(t,e){const s=Phaser.Math.Angle.Between(t.centerX,t.centerY,e.centerX,e.centerY);return{x:t.centerX+Math.cos(s)*(t.width/2),y:t.centerY+Math.sin(s)*(t.height/2)}}updateResultTextAndWordPoints(t,e){this.resultText.setFontSize("32px"),this.resultText.setText(t).setResolution(this.fontResolution),this.resultText.width>=this.wordBackgroundOuter.width-2*this.padding&&this.resultText.setFontSize("16px"),this.wordBackgroundInner.setStrokeStyle(2,0,1),this.wordBackgroundInner.width=this.resultText.width+2*this.padding,this.wordPointsBackgroundEllipseGraphicObject.clear(),e?(this.resultPointsText.setText(`+${e}`).setResolution(this.fontResolution),this.wordPointsBackgroundEllipseGraphicObject.fillStyle(16777215,1),this.wordPointsBackgroundEllipseGraphicObject.lineStyle(2,0,1),e>=20?this.sound.playAudioSprite("effects","MediumPoints"):this.sound.playAudioSprite("effects","LowPoints")):(this.resultPointsText.setText(""),this.wordPointsBackgroundEllipseGraphicObject.fillStyle(16777215,0),this.wordPointsBackgroundEllipseGraphicObject.lineStyle(2,0,0)),this.wordPointsBackgroundEllipse.x=this.wordBackgroundInner.x+this.wordBackgroundInner.width/2,this.wordPointsBackgroundEllipse.width=this.resultPointsText.width+this.padding/2,this.resultPointsText.x=this.wordPointsBackgroundEllipse.x,this.wordPointsBackgroundEllipseGraphicObject.fillEllipseShape(this.wordPointsBackgroundEllipse),this.wordPointsBackgroundEllipseGraphicObject.strokeEllipseShape(this.wordPointsBackgroundEllipse,128)}updateTotalPointsText(){this.totalPointsText.setText(this.totalPoints).setResolution(this.fontResolution)}updateTimer(){this.countdown>0?(this.countdown--,this.timerText.setText(this.formatTime(this.countdown)),5==this.countdown&&this.sound.playAudioSprite("effects","TickTock")):(this.timerText.setText("00:00"),this.sound.playAudioSprite("effects","Cheers"),this.scene.start("GameOver",{foundWords:this.foundWords.size,totalNumberOfWords:this.words.length,totalPoints:this.totalPoints,longestWord:this.longestWord,mostValuableWord:this.mostValuableWord}))}formatTime(t){const e=Math.floor(t/60),s=t%60;return`${this.pad(e)}:${this.pad(s)}`}pad(t){return t.toString().padStart(2,"0")}shrinkCell(t){this.tweens.add({targets:t,scaleX:1,scaleY:1,ease:"Linear",duration:500,repeat:0,yoyo:!1})}growCell(t){this.tweens.add({targets:t,scaleX:1.05,scaleY:1.05,ease:"Elastic",duration:500,repeat:0,yoyo:!1})}}class C extends s.Scene{constructor(){super("GameOver")}init(t){console.log("init",t),this.foundWords=t.foundWords,this.totalPoints=t.totalPoints,this.longestWord=t.longestWord,this.totalNumberOfWords=t.totalNumberOfWords,this.mostValuableWord=t.mostValuableWord,this.fontResolution=2}create(){this.cameras.main.setBackgroundColor(68719476735),this.cameras.main.setZoom(4.2);const t=10,e=this.sys.game.config.width/2-115,s=this.sys.game.config.height/2-120,i="18px",o="#000000";let n=new B(this,{x:e-20,y:s-160,width:270,height:410,radius:6,strokeColor:0,strokeWidth:2,color:void 0,alpha:0}).setOrigin(0,0);this.add.existing(n);const r=this.add.text(this.sys.game.config.width/2,this.sys.game.config.height/2-200+t,"게임 종료",{fontSize:"32px",color:"#000000",padding:{top:t,bottom:t}}).setOrigin(.5,.5).setResolution(this.fontResolution);this.add.text(e,s,`총점:          ${this.totalPoints}`,{fontSize:i,color:o,padding:{top:t,bottom:t}}).setOrigin(0,0).setResolution(this.fontResolution),this.add.text(e,s+50,`찾은 단어수:   ${this.totalNumberOfWords}  중 ${this.foundWords}`,{fontSize:i,color:o,padding:{top:t,bottom:t}}).setOrigin(0,0).setResolution(this.fontResolution),this.add.text(e,s+100,`최고점 단어:    ${this.mostValuableWord}`,{fontSize:i,color:o,padding:{top:t,bottom:t}}).setOrigin(0,0).setResolution(this.fontResolution),this.add.text(e,s+150,`최장 단어:      ${this.longestWord}`,{fontSize:i,color:o,padding:{top:t,bottom:t}}).setOrigin(0,0).setResolution(this.fontResolution);const h=r.getBounds(),a=h.y+h.height+5;this.graphics=this.add.graphics({lineStyle:{width:5,color:0}}),this.graphics.lineStyle(3,0),this.graphics.beginPath(),this.graphics.moveTo(h.x-25,a),this.graphics.lineTo(h.x+h.width+25,a),this.graphics.strokePath(),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")}))}}class N extends s.Scene{constructor(){super("MainMenu")}create(){this.cameras.main.setZoom(1),this.cameras.main.setBackgroundColor(4294967295);const t=this.sys.game.config.width/2,e=this.sys.game.config.height/4;this.add.text(t,e,"연글",{fontFamily:"Arial Black",fontSize:200,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5);const s=e+400,i=this.add.text(t,s,"게임 방법",{fontFamily:"Arial",fontSize:50,color:"#ffffff",stroke:"#000000",strokeThickness:5,align:"center"}).setOrigin(.5),o=s+100,n=this.add.text(t,o,"게임 시작",{fontFamily:"Arial",fontSize:50,color:"#ffffff",stroke:"#000000",strokeThickness:5,align:"center"}).setOrigin(.5);i.setInteractive().on("pointerdown",(()=>{this.showHelpText(t,s-100)})),n.setInteractive().on("pointerdown",(()=>{this.scene.start("Game")})),this.input.on("pointerdown",(t=>{this.hideHelpText(t)}))}showHelpText(t,e){this.helpBackground=this.add.rectangle(t,e,900,700,0).setOrigin(.5),this.helpText=this.add.text(t,e,"\n        1. 이 게임의 목표는 인접한 글자들을 연결하여 단어를 찾는 것입니다!\n        \n        2. 이중 또는 삼중 글자 보너스(ㄱx2 또는 ㄱx3)나 이중 또는 삼중 단어 보너스(가x2 또는 가x3)를 포함하여 추가 점수를 얻으세요.\n        ",{fontFamily:"Arial",fontSize:50,color:"#ffffff",align:"left",wordWrap:{width:550}}).setOrigin(.5),this.children.bringToTop(this.helpBackground),this.children.bringToTop(this.helpText),this.helpTextVisible=!0}hideHelpText(t){this.helpTextVisible&&(this.helpBackground.getBounds().contains(t.x,t.y)||(this.helpBackground.destroy(),this.helpText.destroy(),this.helpTextVisible=!1))}}class W extends s.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const t=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(e=>{t.width=4+460*e}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png"),this.load.image("dragon","dragon.png"),this.load.audioSprite("tones","../assets/audio/audioTones.json",["../assets/audio/Xylophone.ogg","../assets/audio/Xylophone.mp3"]),this.load.audioSprite("effects","../assets/audio/audioEffects.json",["../assets/audio/AllEffectSounds.ogg","../assets/audio/AllEffectSounds.mp3"])}create(){this.scene.start("MainMenu")}}const A={type:Phaser.AUTO,width:1236,height:2745,parent:"game-container",backgroundColor:"#028af8",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[i,W,N,E,C],fps:{target:60,forceSetTimeOut:!0},autoFocus:!0,visibilityChangePause:!1};new Phaser.Game(A);
